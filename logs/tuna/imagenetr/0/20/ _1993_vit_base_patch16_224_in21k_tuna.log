2025-08-08 14:29:41,799 [trainer.py] => config: ./exps/tuna_imgr.json
2025-08-08 14:29:41,800 [trainer.py] => prefix:  
2025-08-08 14:29:41,800 [trainer.py] => dataset: imagenetr
2025-08-08 14:29:41,800 [trainer.py] => memory_size: 0
2025-08-08 14:29:41,800 [trainer.py] => memory_per_class: 0
2025-08-08 14:29:41,800 [trainer.py] => fixed_memory: False
2025-08-08 14:29:41,800 [trainer.py] => shuffle: True
2025-08-08 14:29:41,800 [trainer.py] => init_cls: 20
2025-08-08 14:29:41,800 [trainer.py] => increment: 20
2025-08-08 14:29:41,800 [trainer.py] => model_name: tuna
2025-08-08 14:29:41,800 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_tuna
2025-08-08 14:29:41,800 [trainer.py] => device: [device(type='cuda', index=2)]
2025-08-08 14:29:41,800 [trainer.py] => seed: 1993
2025-08-08 14:29:41,800 [trainer.py] => tuned_epoch: 10
2025-08-08 14:29:41,800 [trainer.py] => init_lr: 0.02
2025-08-08 14:29:41,800 [trainer.py] => batch_size: 32
2025-08-08 14:29:41,800 [trainer.py] => weight_decay: 0.0005
2025-08-08 14:29:41,800 [trainer.py] => min_lr: 0
2025-08-08 14:29:41,800 [trainer.py] => optimizer: sgd
2025-08-08 14:29:41,800 [trainer.py] => scheduler: cosine
2025-08-08 14:29:41,800 [trainer.py] => reinit_optimizer: True
2025-08-08 14:29:41,800 [trainer.py] => init_milestones: [10]
2025-08-08 14:29:41,800 [trainer.py] => init_lr_decay: 0.1
2025-08-08 14:29:41,801 [trainer.py] => reg: 0.001
2025-08-08 14:29:41,801 [trainer.py] => use_orth: True
2025-08-08 14:29:41,801 [trainer.py] => crct_epochs: 30
2025-08-08 14:29:41,801 [trainer.py] => ca_lr: 0.005
2025-08-08 14:29:41,801 [trainer.py] => ca_storage_efficient_method: covariance
2025-08-08 14:29:41,801 [trainer.py] => ca_storage_efficient_method_choices: ['covariance', 'variance']
2025-08-08 14:29:41,801 [trainer.py] => decay: True
2025-08-08 14:29:41,801 [trainer.py] => pretrained: True
2025-08-08 14:29:41,801 [trainer.py] => drop: 0.0
2025-08-08 14:29:41,801 [trainer.py] => drop_path: 0.0
2025-08-08 14:29:41,801 [trainer.py] => r: 16
2025-08-08 14:29:41,801 [trainer.py] => scale: 20.0
2025-08-08 14:29:41,801 [trainer.py] => m: 0.0
2025-08-08 14:29:41,940 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2025-08-08 14:29:47,620 [tuna.py] => 86,256,776 model total parameters.
2025-08-08 14:29:47,621 [tuna.py] => 458,120 model training parameters.
2025-08-08 14:29:47,622 [tuna.py] => backbone.head.weight: 153600
2025-08-08 14:29:47,622 [tuna.py] => backbone.head.bias: 200
2025-08-08 14:29:47,622 [tuna.py] => backbone.cur_adapter.0.down_proj.weight: 12288
2025-08-08 14:29:47,622 [tuna.py] => backbone.cur_adapter.0.down_proj.bias: 16
2025-08-08 14:29:47,622 [tuna.py] => backbone.cur_adapter.0.up_proj.weight: 12288
2025-08-08 14:29:47,622 [tuna.py] => backbone.cur_adapter.0.up_proj.bias: 768
2025-08-08 14:29:47,622 [tuna.py] => backbone.cur_adapter.1.down_proj.weight: 12288
2025-08-08 14:29:47,622 [tuna.py] => backbone.cur_adapter.1.down_proj.bias: 16
2025-08-08 14:29:47,622 [tuna.py] => backbone.cur_adapter.1.up_proj.weight: 12288
2025-08-08 14:29:47,622 [tuna.py] => backbone.cur_adapter.1.up_proj.bias: 768
2025-08-08 14:29:47,622 [tuna.py] => backbone.cur_adapter.2.down_proj.weight: 12288
2025-08-08 14:29:47,622 [tuna.py] => backbone.cur_adapter.2.down_proj.bias: 16
2025-08-08 14:29:47,622 [tuna.py] => backbone.cur_adapter.2.up_proj.weight: 12288
2025-08-08 14:29:47,622 [tuna.py] => backbone.cur_adapter.2.up_proj.bias: 768
2025-08-08 14:29:47,622 [tuna.py] => backbone.cur_adapter.3.down_proj.weight: 12288
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.3.down_proj.bias: 16
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.3.up_proj.weight: 12288
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.3.up_proj.bias: 768
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.4.down_proj.weight: 12288
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.4.down_proj.bias: 16
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.4.up_proj.weight: 12288
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.4.up_proj.bias: 768
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.5.down_proj.weight: 12288
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.5.down_proj.bias: 16
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.5.up_proj.weight: 12288
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.5.up_proj.bias: 768
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.6.down_proj.weight: 12288
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.6.down_proj.bias: 16
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.6.up_proj.weight: 12288
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.6.up_proj.bias: 768
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.7.down_proj.weight: 12288
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.7.down_proj.bias: 16
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.7.up_proj.weight: 12288
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.7.up_proj.bias: 768
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.8.down_proj.weight: 12288
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.8.down_proj.bias: 16
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.8.up_proj.weight: 12288
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.8.up_proj.bias: 768
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.9.down_proj.weight: 12288
2025-08-08 14:29:47,623 [tuna.py] => backbone.cur_adapter.9.down_proj.bias: 16
2025-08-08 14:29:47,624 [tuna.py] => backbone.cur_adapter.9.up_proj.weight: 12288
2025-08-08 14:29:47,624 [tuna.py] => backbone.cur_adapter.9.up_proj.bias: 768
2025-08-08 14:29:47,624 [tuna.py] => backbone.cur_adapter.10.down_proj.weight: 12288
2025-08-08 14:29:47,624 [tuna.py] => backbone.cur_adapter.10.down_proj.bias: 16
2025-08-08 14:29:47,624 [tuna.py] => backbone.cur_adapter.10.up_proj.weight: 12288
2025-08-08 14:29:47,624 [tuna.py] => backbone.cur_adapter.10.up_proj.bias: 768
2025-08-08 14:29:47,624 [tuna.py] => backbone.cur_adapter.11.down_proj.weight: 12288
2025-08-08 14:29:47,624 [tuna.py] => backbone.cur_adapter.11.down_proj.bias: 16
2025-08-08 14:29:47,624 [tuna.py] => backbone.cur_adapter.11.up_proj.weight: 12288
2025-08-08 14:29:47,624 [tuna.py] => backbone.cur_adapter.11.up_proj.bias: 768
2025-08-08 14:29:47,625 [trainer.py] => All params: 86256776
2025-08-08 14:29:47,625 [trainer.py] => Trainable params: 458120
2025-08-08 14:29:47,626 [tuna.py] => Learning on 0-20
2025-08-08 14:32:00,759 [tuna.py] => Task 0, Epoch 10/10 => Loss 0.331, Train_accy 91.62
2025-08-08 14:32:29,797 [trainer.py] => No NME accuracy.
2025-08-08 14:32:29,798 [trainer.py] => CNN: {'total': 92.89, '00-19': 92.89, 'old': 0, 'new': 92.89}
2025-08-08 14:32:29,799 [trainer.py] => CNN top1 curve: [92.89]
2025-08-08 14:32:29,799 [trainer.py] => CNN top5 curve: [98.98]

2025-08-08 14:32:29,799 [trainer.py] => Average Accuracy (CNN): 92.89 

2025-08-08 14:32:29,800 [trainer.py] => All params: 86576456
2025-08-08 14:32:29,801 [trainer.py] => Trainable params: 777800
2025-08-08 14:32:29,802 [tuna.py] => Learning on 20-40
2025-08-08 14:35:05,697 [tuna.py] => Task 1, Epoch 10/10 => Loss 0.324, Train_accy 88.13
2025-08-08 14:35:38,994 [tuna.py] => Task 1, Epoch 30/30 => Loss 0.165, CA_accy 98.52
2025-08-08 14:35:47,844 [trainer.py] => No NME accuracy.
2025-08-08 14:35:47,845 [trainer.py] => CNN: {'total': 88.57, '00-19': 88.1, '20-39': 89.08, 'old': 88.1, 'new': 89.08}
2025-08-08 14:35:47,845 [trainer.py] => CNN top1 curve: [92.89, 88.57]
2025-08-08 14:35:47,845 [trainer.py] => CNN top5 curve: [98.98, 97.88]

2025-08-08 14:35:47,845 [trainer.py] => Average Accuracy (CNN): 90.72999999999999 

2025-08-08 14:35:47,846 [trainer.py] => All params: 87200456
2025-08-08 14:35:47,847 [trainer.py] => Trainable params: 1401800
2025-08-08 14:35:47,856 [tuna.py] => Learning on 40-60
2025-08-08 14:38:14,427 [tuna.py] => Task 2, Epoch 10/10 => Loss 0.367, Train_accy 83.78
2025-08-08 14:38:52,066 [tuna.py] => Task 2, Epoch 30/30 => Loss 0.195, CA_accy 98.55
2025-08-08 14:39:07,926 [trainer.py] => No NME accuracy.
2025-08-08 14:39:07,926 [trainer.py] => CNN: {'total': 87.18, '00-19': 86.65, '20-39': 86.08, '40-59': 88.94, 'old': 86.37, 'new': 88.94}
2025-08-08 14:39:07,926 [trainer.py] => CNN top1 curve: [92.89, 88.57, 87.18]
2025-08-08 14:39:07,926 [trainer.py] => CNN top5 curve: [98.98, 97.88, 96.99]

2025-08-08 14:39:07,926 [trainer.py] => Average Accuracy (CNN): 89.54666666666667 

2025-08-08 14:39:07,928 [trainer.py] => All params: 87520136
2025-08-08 14:39:07,929 [trainer.py] => Trainable params: 1721480
2025-08-08 14:39:07,938 [tuna.py] => Learning on 60-80
2025-08-08 14:41:37,351 [tuna.py] => Task 3, Epoch 10/10 => Loss 0.325, Train_accy 81.33
2025-08-08 14:42:27,474 [tuna.py] => Task 3, Epoch 30/30 => Loss 0.206, CA_accy 98.44
2025-08-08 14:42:51,940 [trainer.py] => No NME accuracy.
2025-08-08 14:42:51,941 [trainer.py] => CNN: {'total': 85.03, '00-19': 85.05, '20-39': 83.86, '40-59': 86.63, '60-79': 84.59, 'old': 85.16, 'new': 84.59}
2025-08-08 14:42:51,941 [trainer.py] => CNN top1 curve: [92.89, 88.57, 87.18, 85.03]
2025-08-08 14:42:51,941 [trainer.py] => CNN top5 curve: [98.98, 97.88, 96.99, 95.56]

2025-08-08 14:42:51,941 [trainer.py] => Average Accuracy (CNN): 88.41749999999999 

2025-08-08 14:42:51,943 [trainer.py] => All params: 87839816
2025-08-08 14:42:51,944 [trainer.py] => Trainable params: 2041160
2025-08-08 14:42:51,945 [tuna.py] => Learning on 80-100
2025-08-08 14:45:17,555 [tuna.py] => Task 4, Epoch 10/10 => Loss 0.345, Train_accy 78.21
2025-08-08 14:46:07,617 [tuna.py] => Task 4, Epoch 30/30 => Loss 0.233, CA_accy 98.36
2025-08-08 14:46:47,564 [trainer.py] => No NME accuracy.
2025-08-08 14:46:47,565 [trainer.py] => CNN: {'total': 82.58, '00-19': 82.73, '20-39': 82.44, '40-59': 83.17, '60-79': 82.31, '80-99': 82.14, 'old': 82.67, 'new': 82.14}
2025-08-08 14:46:47,565 [trainer.py] => CNN top1 curve: [92.89, 88.57, 87.18, 85.03, 82.58]
2025-08-08 14:46:47,565 [trainer.py] => CNN top5 curve: [98.98, 97.88, 96.99, 95.56, 94.61]

2025-08-08 14:46:47,565 [trainer.py] => Average Accuracy (CNN): 87.24999999999999 

2025-08-08 14:46:47,567 [trainer.py] => All params: 88159496
2025-08-08 14:46:47,568 [trainer.py] => Trainable params: 2360840
2025-08-08 14:46:47,569 [tuna.py] => Learning on 100-120
2025-08-08 14:49:46,062 [tuna.py] => Task 5, Epoch 10/10 => Loss 0.318, Train_accy 77.45
2025-08-08 14:50:54,598 [tuna.py] => Task 5, Epoch 30/30 => Loss 0.234, CA_accy 98.51
2025-08-08 14:51:42,886 [trainer.py] => No NME accuracy.
2025-08-08 14:51:42,886 [trainer.py] => CNN: {'total': 82.09, '00-19': 79.54, '20-39': 80.7, '40-59': 81.68, '60-79': 80.74, '80-99': 81.31, '100-119': 88.18, 'old': 80.74, 'new': 88.18}
2025-08-08 14:51:42,886 [trainer.py] => CNN top1 curve: [92.89, 88.57, 87.18, 85.03, 82.58, 82.09]
2025-08-08 14:51:42,886 [trainer.py] => CNN top5 curve: [98.98, 97.88, 96.99, 95.56, 94.61, 94.46]

2025-08-08 14:51:42,886 [trainer.py] => Average Accuracy (CNN): 86.38999999999999 

2025-08-08 14:51:42,888 [trainer.py] => All params: 88479176
2025-08-08 14:51:42,890 [trainer.py] => Trainable params: 2680520
2025-08-08 14:51:42,891 [tuna.py] => Learning on 120-140
2025-08-08 14:54:10,731 [tuna.py] => Task 6, Epoch 10/10 => Loss 0.302, Train_accy 79.52
2025-08-08 14:55:19,691 [tuna.py] => Task 6, Epoch 30/30 => Loss 0.245, CA_accy 98.53
2025-08-08 14:56:27,723 [trainer.py] => No NME accuracy.
2025-08-08 14:56:27,723 [trainer.py] => CNN: {'total': 81.99, '00-19': 78.96, '20-39': 80.7, '40-59': 80.53, '60-79': 79.51, '80-99': 81.31, '100-119': 87.12, '120-139': 85.76, 'old': 81.4, 'new': 85.76}
2025-08-08 14:56:27,723 [trainer.py] => CNN top1 curve: [92.89, 88.57, 87.18, 85.03, 82.58, 82.09, 81.99]
2025-08-08 14:56:27,723 [trainer.py] => CNN top5 curve: [98.98, 97.88, 96.99, 95.56, 94.61, 94.46, 93.76]

2025-08-08 14:56:27,723 [trainer.py] => Average Accuracy (CNN): 85.76142857142857 

2025-08-08 14:56:27,725 [trainer.py] => All params: 88798856
2025-08-08 14:56:27,726 [trainer.py] => Trainable params: 3000200
2025-08-08 14:56:27,727 [tuna.py] => Learning on 140-160
2025-08-08 14:59:50,281 [tuna.py] => Task 7, Epoch 10/10 => Loss 0.315, Train_accy 75.43
2025-08-08 15:01:14,128 [tuna.py] => Task 7, Epoch 30/30 => Loss 0.268, CA_accy 98.27
2025-08-08 15:02:38,207 [trainer.py] => No NME accuracy.
2025-08-08 15:02:38,207 [trainer.py] => CNN: {'total': 81.41, '00-19': 77.5, '20-39': 79.59, '40-59': 79.54, '60-79': 78.28, '80-99': 79.26, '100-119': 86.52, '120-139': 83.66, '140-159': 85.73, 'old': 80.66, 'new': 85.73}
2025-08-08 15:02:38,207 [trainer.py] => CNN top1 curve: [92.89, 88.57, 87.18, 85.03, 82.58, 82.09, 81.99, 81.41]
2025-08-08 15:02:38,207 [trainer.py] => CNN top5 curve: [98.98, 97.88, 96.99, 95.56, 94.61, 94.46, 93.76, 93.04]

2025-08-08 15:02:38,207 [trainer.py] => Average Accuracy (CNN): 85.21749999999999 

2025-08-08 15:02:38,210 [trainer.py] => All params: 89118536
2025-08-08 15:02:38,212 [trainer.py] => Trainable params: 3319880
2025-08-08 15:02:38,213 [tuna.py] => Learning on 160-180
2025-08-08 15:05:13,279 [tuna.py] => Task 8, Epoch 10/10 => Loss 0.354, Train_accy 76.85
2025-08-08 15:06:40,760 [tuna.py] => Task 8, Epoch 30/30 => Loss 0.278, CA_accy 98.27
2025-08-08 15:08:21,258 [trainer.py] => No NME accuracy.
2025-08-08 15:08:21,258 [trainer.py] => CNN: {'total': 79.84, '00-19': 74.89, '20-39': 79.11, '40-59': 77.39, '60-79': 76.88, '80-99': 77.62, '100-119': 84.09, '120-139': 82.6, '140-159': 83.13, '160-179': 82.64, 'old': 79.57, 'new': 82.64}
2025-08-08 15:08:21,259 [trainer.py] => CNN top1 curve: [92.89, 88.57, 87.18, 85.03, 82.58, 82.09, 81.99, 81.41, 79.84]
2025-08-08 15:08:21,259 [trainer.py] => CNN top5 curve: [98.98, 97.88, 96.99, 95.56, 94.61, 94.46, 93.76, 93.04, 92.34]

2025-08-08 15:08:21,259 [trainer.py] => Average Accuracy (CNN): 84.61999999999999 

2025-08-08 15:08:21,261 [trainer.py] => All params: 89438216
2025-08-08 15:08:21,262 [trainer.py] => Trainable params: 3639560
2025-08-08 15:08:21,263 [tuna.py] => Learning on 180-200
2025-08-08 15:11:41,984 [tuna.py] => Task 9, Epoch 10/10 => Loss 0.315, Train_accy 71.85
2025-08-08 15:13:10,135 [tuna.py] => Task 9, Epoch 30/30 => Loss 0.291, CA_accy 98.09
2025-08-08 15:15:14,110 [trainer.py] => No NME accuracy.
2025-08-08 15:15:14,111 [trainer.py] => CNN: {'total': 79.3, '00-19': 74.46, '20-39': 76.58, '40-59': 76.24, '60-79': 75.31, '80-99': 75.98, '100-119': 82.88, '120-139': 81.72, '140-159': 82.99, '160-179': 81.38, '180-199': 85.15, 'old': 78.68, 'new': 85.15}
2025-08-08 15:15:14,111 [trainer.py] => CNN top1 curve: [92.89, 88.57, 87.18, 85.03, 82.58, 82.09, 81.99, 81.41, 79.84, 79.3]
2025-08-08 15:15:14,111 [trainer.py] => CNN top5 curve: [98.98, 97.88, 96.99, 95.56, 94.61, 94.46, 93.76, 93.04, 92.34, 91.75]

2025-08-08 15:15:14,111 [trainer.py] => Average Accuracy (CNN): 84.088 

2025-08-08 15:15:14,112 [trainer.py] => Forgetting (CNN): 8.04555555555556
